#!/bin/sh
# Detect Canary Tokens
clear
/bin/cat << 'hexstr1p'
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣾⣿⡿⢋⣴⡿⢛⣿⣿⠏⡡⠈⡿⠋⠀⢰⡈⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡗⠈⢻⣿⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡔⣡⡿⠋⣰⡿⢋⣰⣿⠟⢡⡞⢁⡾⢁⠀⠀⠈⣷⠘⣿⡿⠿⣿⣿⣏⢻⣏⠻⣿⣿⣿⡄⠀⢻⣿⣿⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢀⠎⣠⠟⢀⣾⡟⣡⣿⣿⡏⢠⠟⢠⡾⢁⣾⣿⣷⡀⣿⡇⢹⣿⡌⠈⢿⣿⣆⢻⣆⢻⣿⣿⣿⡄⠀⣿⣿⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢠⠎⣰⠏⢀⣾⡟⣰⣿⣿⡿⢠⠏⢠⣿⠃⣾⣿⣿⣿⡇⢿⣇⢸⣿⣿⡄⠈⣿⣿⡆⢿⡎⣿⣿⣿⣿⡀⠸⢿⣧⡙⢇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⢠⠏⣼⠏⢀⣾⣿⢱⣿⣿⣿⢃⠏⠀⣾⡏⣼⣿⣿⣿⣿⣧⢸⣿⠸⣿⣿⣿⡄⠸⣿⣿⡈⣿⣸⣿⣿⣿⣷⠀⣆⢻⣿⡌⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢀⡎⣸⡟⢠⣿⣿⣇⣿⣿⣿⡏⡜⣸⢸⡿⢠⣿⣿⣿⣿⣿⣿⢸⣿⠀⠸⣿⣿⣿⡄⢻⣿⣇⢹⡇⣿⣿⣿⣿⡇⢹⡄⢿⢿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣼⢰⣿⠃⣾⣿⣿⢸⣿⣿⣿⠇⣰⡇⣿⡇⣸⣿⣿⣿⣿⣿⣿⢸⣿⣠⠡⠹⣿⣿⣧⠘⣿⣿⡆⣷⢸⣿⣿⣿⣷⢸⣷⠸⣇⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⣸⡇⣾⣿⢸⣿⣿⡏⣼⣿⣿⣿⢀⣿⡇⣿⠁⣿⣿⣿⣿⣿⣿⣿⢸⡏⣿⣧⠡⠹⣿⣿⡆⢻⣿⣷⢸⠘⣿⣿⣿⣿⠸⣿⡇⢻⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢀⡟⢰⣿⡏⣿⣿⣿⣇⣿⢸⣿⣿⠘⣉⡁⢻⠀⠙⣿⣿⣿⣿⣿⣿⣸⢧⣯⣤⣴⡆⢻⣿⣧⠸⣿⡿⠘⠀⣿⣿⣿⣿⠀⣿⣇⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢸⠃⢸⣿⡏⣿⣿⣿⣿⢹⠀⢿⣿⢸⣿⡇⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣾⣿⣿⣿⣷⢈⣿⡏⢀⣿⡇⡀⢰⣿⣿⣿⡿⢀⢹⠿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⣿⠀⢺⣿⡇⣿⣿⣿⣿⠸⢸⡌⢿⣼⣿⡿⠿⠹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⣛⣘⡻⠃⣿⣿⣇⡇⣼⣿⣿⣿⡇⠸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⡇⠀⢸⣿⠀⢿⣿⣿⣿⡆⠀⣿⣮⡣⡶⠶⠾⠆⢾⣿⣿⣿⣿⣿⣯⣿⣿⣿⡟⠉⠁⠈⠁⠙⠛⠹⣿⢧⣿⣿⣿⢿⠇⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠁⠀⠀⢿⡀⠸⠘⢿⣿⣿⡀⣸⠟⠁⠀⣀⣤⣤⣤⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣴⣾⣶⣷⣶⣶⣶⣾⡿⣿⣿⢏⡼⠈⣵⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⢀⠀⠘⡇⠀⠀⢨⡻⢿⣧⡸⣶⣿⣿⣿⣿⣿⣿⣿⣿⡿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣵⡿⢫⢯⣦⠤⣼⡇⢠⢀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀
⠄⠁⠀⠀⠀⠀⠀⠀⠀⠀⣌⢿⢠⡉⢻⣟⣿⣿⣿⣿⣿⣿⣿⣿⢣⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⣽⣿⣿⣿⣻⡿⠀⠀⣿⠆⡜⢀⣴⣿⠟⢛⠁⡀⠀⠐⠀⠈
⣀⣟⣞⣣⣶⣠⣼⣶⣤⢸⣿⣦⣼⣧⠐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣜⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⣽⣿⣿⣿⣟⣧⣤⣠⣿⡞⢱⡿⠋⠱⢮⡓⠀⢲⠒⠀⣠⢦
⣿⣿⣿⣿⣿⣿⣿⣿⣿⢾⣿⡟⣿⣿⣆⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⡿⠿⠛⠁⠂⠈⣾⣧⢳⢀⠹⠀⣆⣾⢧⣸⣧
⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⣿⡇⣿⣿⣿⠈⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡷⠀⢀⣡⣾⠇⡀⠀⣿⣿⡸⣾⡆⠂⣿⠛⣮⣥⣜
⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣿⣇⣿⣿⣿⢸⣆⠻⣿⣿⣿⣿⣿⣿⣛⣿⣿⣿⣿⣿⣿⣭⣶⣿⣿⣿⣿⣿⣿⣿⣿⡃⢠⣶⣭⣿⣴⣧⣄⣿⣿⣧⣿⢹⣆⠹⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣿⣿⣿⣿⣿⣿⡇⠀⣮⡛⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣽⣿⣿⣽⣿⣿⣿⣷⢩⣭⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⢹⣦⢻⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⡇⣿⣹⣿⣾⣿⢹⡟⡇⢹⡼⣿⣷⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⢟⣿⣿⣿⣿⣿⣿⣿⣿⡜⣻⣷⣝⢿⡟⣿⣿⣿⣿⣿⣿⡆⢿⣏⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣿⣧⢸⣿⣿⣿⣿⣿⡇⡇⢸⣿⣾⡿⣿⣿⡿⣛⠿⣿⣿⣿⠿⣛⡩⢾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣿⢻⣿⣦⣙⡿⣿⣿⣿⣿⣿⣷⡼⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⢿⡿⢃⣥⣍⣻⣿⣿⡇⢣⢸⣿⣿⣿⡶⠆⣴⣿⣷⠀⠀⠀⠘⠁⢀⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⣼⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⡇⣿⣿⣿⣿
⣿⣿⣿⣿⣿⣿⣿⣷⡐⢹⣿⣿⣿⣿⣿⣿⠘⡄⣿⡿⠋⠀⢰⣿⣿⠋⢀⠀⠀⠀⠀⠐⠁⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⣿⣿⣿⣿⣷⣿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⡟⢩⣿⣿⣿⠻⢿⣿⠿⠟⡛⠛⣿⣿⣿⣿⡆⠃⠋⠀⢠⣄⣿⣿⣿⠀⣸⣆⠀⠀⠀⢀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣏⣿⣼⣿⣿⣿⡟⢻⢿⣿⣿⣿
⢠⠼⣿⣿⢿⣶⣦⣄⠄⣾⣿⣿⣿⣿⣿⡿⢧⠀⠀⣶⡿⣼⣿⣿⣿⡇⣿⣿⡆⢠⠁⣎⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⢊⠄⠈⠙⠛
⣿⣡⣿⣿⣿⢿⣿⣿⡆⣿⣿⣿⣿⣿⣿⣿⣞⡇⢀⢻⢣⣿⣿⣿⣿⣷⢸⣿⣿⡀⠐⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⣠⣾⣿⣴⣤⣠
⠋⣿⣿⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠘⡟⣾⣿⣿⣿⣿⣿⡄⡿⣿⡇⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣻⣿⣿⢹⠁⣿⣿⣿⣿⣿⣿
hexstr1p
tput setaf 3
echo ""
echo "Detect Canary Tokens in MS Word docs"
echo "a tiny hack by hexstr1p (@hexstr1p)"
echo ""
tput sgr0
read -p "Please enter the name of the Word file: " file
if [ ! -f $file ]
then
  echo "I can't find that file."
  exit 1
fi

if [[ $file == *.docx ]] || [[ $file == *.doc ]]
then
  unzip -o $file
  if [ ! -f word/footer1.xml ]
  then
    echo "********************************************************************"
    echo "[-] No canary found! File should be OK!"
    echo "********************************************************************"
    exit 1
  fi
  if grep -q canarytoken word/footer2.xml word/footer1.xml word/footer3.xml word/header1.xml word/header2.xml word/header3.xml;
  then
    echo "********************************************************************"
    tput setaf 1
    echo "[x] Canary detected! Do not open while connected to the internet!"
    tput sgr0
    echo "********************************************************************"
  else
    echo "********************************************************************"
    tput setaf 2
    echo "[-] No canary found! File should be OK!"
    tput sgr0
    echo "********************************************************************"
  fi
  rm -rf word docPropps _rels
  echo "This does not seem to be a Word document."
fi

